{"entries":[{"timestamp":1733908674257,"editorVersion":"7.0.51","changes":[{"type":"edited","filename":"main.blocks","patch":[{"diffs":[[0,"iables><"],[1,"block type=\"device_button_event\" x=\"562\" y=\"20\"><field name=\"NAME\">Button.A</field><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"sonar_ping\"><field name=\"trig\">DigitalPin.P1</field><field name=\"echo\">DigitalPin.P2</field><field name=\"unit\">PingUnit.Centimeters</field></block></value><next><block type=\"device_show_number\"><value name=\"number\"><block type=\"variables_get\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field></block></value></block></next></block></statement></block><block type=\"pxt-on-start\" x=\"49\" y=\"50\"><statement name=\"HANDLER\"><block type=\"radio_set_transmit_power\"><value name=\"power\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"7\" precision=\"0\"></mutation><field name=\"SLIDER\">7</field></shadow></value><next><block type=\"radio_set_group\"><value name=\"ID\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">27</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"|.x|kK%yrB5,o?cs}IKJ\">車序號</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">2</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"@P5qoTxNRCme_Wa[*;tU\">前車固定車距</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">7</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"QWzxQ9:$T;1VBT.m5=u3\">車距kP</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">35</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Sh~34{[m!|mWEVa744}0\">基本速度</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">200</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"device_button_event\" x=\"1025\" y=\"20\"><field name=\"NAME\">Button.B</field><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation elseif=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{igIt8`1}+6zL;D=zE%M\">校正模式</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"text\"><field name=\"TEXT\"></field></block></value></block></value><statement name=\"DO0\"><block type=\"device_show_leds\"><field name=\"LEDS\">`\n        # # . # # \n        # # . # # \n        # # . # # \n        # # . # # \n        # # . # #\n        `</field><next><block type=\"device_play_note\"><value name=\"note\"><shadow type=\"device_note\"><field name=\"name\">523</field></shadow></value><value name=\"duration\"><shadow type=\"device_beat\"><field name=\"fraction\">BeatFraction.Eighth</field></shadow></value><next><block type=\"sensor_StartSampling\"><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{igIt8`1}+6zL;D=zE%M\">校正模式</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"text\"><field name=\"TEXT\">黑線校正</field></block></value></block></next></block></next></block></next></block></statement><value name=\"IF1\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{igIt8`1}+6zL;D=zE%M\">校正模式</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"text\"><field name=\"TEXT\">黑線校正</field></block></value></block></value><statement name=\"DO1\"><block type=\"sensor_EndSampling\"><field name=\"Color\">BitRacer.LineColor.Black</field><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Yes</field><next><block type=\"device_play_note\"><value name=\"note\"><shadow type=\"device_note\"><field name=\"name\">659</field></shadow></value><value name=\"duration\"><shadow type=\"device_beat\"><field name=\"fraction\">BeatFraction.Eighth</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{igIt8`1}+6zL;D=zE%M\">校正模式</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"text\"><field name=\"TEXT\"></field></block></value><next><block type=\"device_clear_display\"></block></next></block></next></block></next></block></next></block></statement></block></statement></block><block type=\"device_button_event\" x=\"1614\" y=\"79\"><field name=\"NAME\">Button.AB</field><statement name=\"HANDLER\"><block type=\"device_show_number\"><value name=\"number\"><block type=\"variables_get\"><field name=\"VAR\" id=\"|.x|kK%yrB5,o?cs}IKJ\">車序號</field></block></value><next><block type=\"device_play_note\"><value name=\"note\"><shadow type=\"device_note\"><field name=\"name\">523</field></shadow></value><value name=\"duration\"><shadow type=\"device_beat\"><field name=\"fraction\">BeatFraction.Quarter</field></shadow></value><next><block type=\"device_while\"><value name=\"COND\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow></value><statement name=\"DO\"><block type=\"variables_set\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"sonar_ping\"><field name=\"trig\">DigitalPin.P1</field><field name=\"echo\">DigitalPin.P2</field><field name=\"unit\">PingUnit.Centimeters</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"+VT$y3SEI1WeMJY/;].@\">車速</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_constrain_value\"><value name=\"value\"><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Sh~34{[m!|mWEVa744}0\">基本速度</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"@P5qoTxNRCme_Wa[*;tU\">前車固定車距</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"QWzxQ9:$T;1VBT.m5=u3\">車距kP</field></block></value></block></value></block></value><value name=\"low\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"high\"><block type=\"variables_get\"><field name=\"VAR\" id=\"Sh~34{[m!|mWEVa744}0\">基本速度</field></block></value></block></value><next><block type=\"function_call\"><mutation name=\"PD控制\" functionid=\"3kbU2GP*Gx/O@-9$L!Ig\"><arg name=\"PWM\" id=\"qjechixv81nu7yi51sdkj\" type=\"number\"></arg><arg name=\"Kp\" id=\"1apz1byywl2l4pcxukkn6\" type=\"number\"></arg><arg name=\"Kd\" id=\"u1qkvbjtytqniykq2k1u0h\" type=\"number\"></arg></mutation><value name=\"qjechixv81nu7yi51sdkj\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"+VT$y3SEI1WeMJY/;].@\">車速</field></block></value><value name=\"1apz1byywl2l4pcxukkn6\"><shadow type=\"math_number\"><field name=\"NUM\">310</field></shadow></value><value name=\"u1qkvbjtytqniykq2k1u0h\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"_^d{}86E2H~]~|qdP}2)\">lastBT</field></block></value></block></value><statement name=\"DO0\"><block type=\"radio_datagram_send_string\"><value name=\"msg\"><block type=\"text_join\" inline=\"false\"><mutation items=\"5\"></mutation><value name=\"ADD0\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"|.x|kK%yrB5,o?cs}IKJ\">車序號</field></block></value><value name=\"ADD1\"><shadow type=\"text\"><field name=\"TEXT\">,</field></shadow></value><value name=\"ADD2\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field></block></value><value name=\"ADD3\"><shadow type=\"text\"><field name=\"TEXT\">,</field></shadow></value><value name=\"ADD4\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"+VT$y3SEI1WeMJY/;].@\">車速</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"_^d{}86E2H~]~|qdP}2)\">lastBT</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_random\"><value name=\"min\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value><value name=\"limit\"><shadow type=\"math_number\"><field name=\"NUM\">300</field></shadow></value></block></value></block></value></block></next></block></statement></block></next></block></next></block></next></block></statement></block></next></block></next></block></statement></block><block type=\"radio_on_number_drag\" x=\"20\" y=\"1033\"><value name=\"HANDLER_DRAG_PARAM_receivedNumber\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">receivedNumber</field></block></value></block><block type=\"function_definition\" x=\"348\" y=\"1033\"><mutation name=\"PD控制\" functionid=\"3kbU2GP*Gx/O@-9$L!Ig\"><arg name=\"PWM\" id=\"qjechixv81nu7yi51sdkj\" type=\"number\"></arg><arg name=\"Kp\" id=\"1apz1byywl2l4pcxukkn6\" type=\"number\"></arg><arg name=\"Kd\" id=\"u1qkvbjtytqniykq2k1u0h\" type=\"number\"></arg></mutation><field name=\"function_name\">PD控制</field><value name=\"qjechixv81nu7yi51sdkj\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">PWM</field></block></value><value name=\"1apz1byywl2l4pcxukkn6\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">Kp</field></block></value><value name=\"u1qkvbjtytqniykq2k1u0h\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">Kd</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"OV.-CSDwj(aOep[3Wy%o\">Error_P</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"sensor_Line\"></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"DY~M9cv~$Wo{wr*?R[c,\">Error_D</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OV.-CSDwj(aOep[3Wy%o\">Error_P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"z_U*EpnX1dejdfI{S0Pn\">Error_P_old</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"z_U*EpnX1dejdfI{S0Pn\">Error_P_old</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OV.-CSDwj(aOep[3Wy%o\">Error_P</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"oxUYfi![}:kg@e_L^^S^\">PID_Val</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OV.-CSDwj(aOep[3Wy%o\">Error_P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">Kp</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"DY~M9cv~$Wo{wr*?R[c,\">Error_D</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">Kd</field></block></value></block></value></block></value><next><block type=\"motor_MotorRun\"><field name=\"index\">BitRacer.Motors.M_R</field><value name=\"PWM\"><shadow type=\"math_number_minmax\"><mutation min=\"-1000\" max=\"1000\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_constrain_value\"><value name=\"value\"><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">PWM</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"oxUYfi![}:kg@e_L^^S^\">PID_Val</field></block></value></block></value><value name=\"low\"><shadow type=\"math_number\"><field name=\"NUM\">-1000</field></shadow></value><value name=\"high\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><next><block type=\"motor_MotorRun\"><field name=\"index\">BitRacer.Motors.M_L</field><value name=\"PWM\"><shadow type=\"math_number_minmax\"><mutation min=\"-1000\" max=\"1000\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_constrain_value\"><value name=\"value\"><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">PWM</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"oxUYfi![}:kg@e_L^^S^\">PID_Val</field></block></value></block></value><value name=\"low\"><shadow type=\"math_number\"><field name=\"NUM\">-1000</field></shadow></value><value name=\"high\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value></block></next></block></next></block></next></block></next></block></next></block></statement></block><"],[0,"/xml>"]],"start1":700,"start2":700,"length1":13,"length2":15768}]},{"type":"edited","filename":"pxt.json","patch":[{"diffs":[[0," ],\n"],[-1,"    \"testFiles\": [\n        \"test.ts\"\n    ],\n"],[0,"    "]],"start1":377,"start2":377,"length1":52,"length2":8}]},{"type":"added","filename":"test.ts","value":"// 在這裡測試；當此封包作為擴充功能時，將不會編譯此內容。\n"}]}],"snapshots":[{"timestamp":1733908674256,"editorVersion":"7.0.51","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</variable><variable id=\"|.x|kK%yrB5,o?cs}IKJ\">車序號</variable><variable id=\"+VT$y3SEI1WeMJY/;].@\">車速</variable><variable id=\"Sh~34{[m!|mWEVa744}0\">基本速度</variable><variable id=\"@P5qoTxNRCme_Wa[*;tU\">前車固定車距</variable><variable id=\"QWzxQ9:$T;1VBT.m5=u3\">車距kP</variable><variable id=\"_^d{}86E2H~]~|qdP}2)\">lastBT</variable><variable id=\"{igIt8`1}+6zL;D=zE%M\">校正模式</variable><variable id=\"OV.-CSDwj(aOep[3Wy%o\">Error_P</variable><variable id=\"DY~M9cv~$Wo{wr*?R[c,\">Error_D</variable><variable id=\"z_U*EpnX1dejdfI{S0Pn\">Error_P_old</variable><variable id=\"oxUYfi![}:kg@e_L^^S^\">PID_Val</variable></variables><block type=\"device_button_event\" x=\"562\" y=\"20\"><field name=\"NAME\">Button.A</field><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"sonar_ping\"><field name=\"trig\">DigitalPin.P1</field><field name=\"echo\">DigitalPin.P2</field><field name=\"unit\">PingUnit.Centimeters</field></block></value><next><block type=\"device_show_number\"><value name=\"number\"><block type=\"variables_get\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field></block></value></block></next></block></statement></block><block type=\"pxt-on-start\" x=\"49\" y=\"50\"><statement name=\"HANDLER\"><block type=\"radio_set_transmit_power\"><value name=\"power\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"7\" precision=\"0\"></mutation><field name=\"SLIDER\">7</field></shadow></value><next><block type=\"radio_set_group\"><value name=\"ID\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"255\" precision=\"0\"></mutation><field name=\"SLIDER\">27</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"|.x|kK%yrB5,o?cs}IKJ\">車序號</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">2</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"@P5qoTxNRCme_Wa[*;tU\">前車固定車距</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">7</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"QWzxQ9:$T;1VBT.m5=u3\">車距kP</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">35</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Sh~34{[m!|mWEVa744}0\">基本速度</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">200</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"device_button_event\" x=\"1025\" y=\"20\"><field name=\"NAME\">Button.B</field><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation elseif=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{igIt8`1}+6zL;D=zE%M\">校正模式</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"text\"><field name=\"TEXT\"></field></block></value></block></value><statement name=\"DO0\"><block type=\"device_show_leds\"><field name=\"LEDS\">`\n        # # . # # \n        # # . # # \n        # # . # # \n        # # . # # \n        # # . # #\n        `</field><next><block type=\"device_play_note\"><value name=\"note\"><shadow type=\"device_note\"><field name=\"name\">523</field></shadow></value><value name=\"duration\"><shadow type=\"device_beat\"><field name=\"fraction\">BeatFraction.Eighth</field></shadow></value><next><block type=\"sensor_StartSampling\"><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{igIt8`1}+6zL;D=zE%M\">校正模式</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"text\"><field name=\"TEXT\">黑線校正</field></block></value></block></next></block></next></block></next></block></statement><value name=\"IF1\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">EQ</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"{igIt8`1}+6zL;D=zE%M\">校正模式</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"text\"><field name=\"TEXT\">黑線校正</field></block></value></block></value><statement name=\"DO1\"><block type=\"sensor_EndSampling\"><field name=\"Color\">BitRacer.LineColor.Black</field><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Yes</field><next><block type=\"device_play_note\"><value name=\"note\"><shadow type=\"device_note\"><field name=\"name\">659</field></shadow></value><value name=\"duration\"><shadow type=\"device_beat\"><field name=\"fraction\">BeatFraction.Eighth</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{igIt8`1}+6zL;D=zE%M\">校正模式</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"text\"><field name=\"TEXT\"></field></block></value><next><block type=\"device_clear_display\"></block></next></block></next></block></next></block></next></block></statement></block></statement></block><block type=\"device_button_event\" x=\"1614\" y=\"79\"><field name=\"NAME\">Button.AB</field><statement name=\"HANDLER\"><block type=\"device_show_number\"><value name=\"number\"><block type=\"variables_get\"><field name=\"VAR\" id=\"|.x|kK%yrB5,o?cs}IKJ\">車序號</field></block></value><next><block type=\"device_play_note\"><value name=\"note\"><shadow type=\"device_note\"><field name=\"name\">523</field></shadow></value><value name=\"duration\"><shadow type=\"device_beat\"><field name=\"fraction\">BeatFraction.Quarter</field></shadow></value><next><block type=\"device_while\"><value name=\"COND\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow></value><statement name=\"DO\"><block type=\"variables_set\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"sonar_ping\"><field name=\"trig\">DigitalPin.P1</field><field name=\"echo\">DigitalPin.P2</field><field name=\"unit\">PingUnit.Centimeters</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"+VT$y3SEI1WeMJY/;].@\">車速</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_constrain_value\"><value name=\"value\"><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Sh~34{[m!|mWEVa744}0\">基本速度</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"@P5qoTxNRCme_Wa[*;tU\">前車固定車距</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"QWzxQ9:$T;1VBT.m5=u3\">車距kP</field></block></value></block></value></block></value><value name=\"low\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"high\"><block type=\"variables_get\"><field name=\"VAR\" id=\"Sh~34{[m!|mWEVa744}0\">基本速度</field></block></value></block></value><next><block type=\"function_call\"><mutation name=\"PD控制\" functionid=\"3kbU2GP*Gx/O@-9$L!Ig\"><arg name=\"PWM\" id=\"qjechixv81nu7yi51sdkj\" type=\"number\"></arg><arg name=\"Kp\" id=\"1apz1byywl2l4pcxukkn6\" type=\"number\"></arg><arg name=\"Kd\" id=\"u1qkvbjtytqniykq2k1u0h\" type=\"number\"></arg></mutation><value name=\"qjechixv81nu7yi51sdkj\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"+VT$y3SEI1WeMJY/;].@\">車速</field></block></value><value name=\"1apz1byywl2l4pcxukkn6\"><shadow type=\"math_number\"><field name=\"NUM\">310</field></shadow></value><value name=\"u1qkvbjtytqniykq2k1u0h\"><shadow type=\"math_number\"><field name=\"NUM\">600</field></shadow></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"_^d{}86E2H~]~|qdP}2)\">lastBT</field></block></value></block></value><statement name=\"DO0\"><block type=\"radio_datagram_send_string\"><value name=\"msg\"><block type=\"text_join\" inline=\"false\"><mutation items=\"5\"></mutation><value name=\"ADD0\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"|.x|kK%yrB5,o?cs}IKJ\">車序號</field></block></value><value name=\"ADD1\"><shadow type=\"text\"><field name=\"TEXT\">,</field></shadow></value><value name=\"ADD2\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"s#Q[X;TWNS0ZHE8DxuBh\">前車距離</field></block></value><value name=\"ADD3\"><shadow type=\"text\"><field name=\"TEXT\">,</field></shadow></value><value name=\"ADD4\"><shadow type=\"text\"><field name=\"TEXT\"></field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"+VT$y3SEI1WeMJY/;].@\">車速</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"_^d{}86E2H~]~|qdP}2)\">lastBT</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"control_running_time\"></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_random\"><value name=\"min\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value><value name=\"limit\"><shadow type=\"math_number\"><field name=\"NUM\">300</field></shadow></value></block></value></block></value></block></next></block></statement></block></next></block></next></block></next></block></statement></block></next></block></next></block></statement></block><block type=\"radio_on_number_drag\" x=\"20\" y=\"1033\"><value name=\"HANDLER_DRAG_PARAM_receivedNumber\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">receivedNumber</field></block></value></block><block type=\"function_definition\" x=\"348\" y=\"1033\"><mutation name=\"PD控制\" functionid=\"3kbU2GP*Gx/O@-9$L!Ig\"><arg name=\"PWM\" id=\"qjechixv81nu7yi51sdkj\" type=\"number\"></arg><arg name=\"Kp\" id=\"1apz1byywl2l4pcxukkn6\" type=\"number\"></arg><arg name=\"Kd\" id=\"u1qkvbjtytqniykq2k1u0h\" type=\"number\"></arg></mutation><field name=\"function_name\">PD控制</field><value name=\"qjechixv81nu7yi51sdkj\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">PWM</field></block></value><value name=\"1apz1byywl2l4pcxukkn6\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">Kp</field></block></value><value name=\"u1qkvbjtytqniykq2k1u0h\"><block type=\"argument_reporter_number\"><mutation duplicateondrag=\"true\"></mutation><field name=\"VALUE\">Kd</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"OV.-CSDwj(aOep[3Wy%o\">Error_P</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"sensor_Line\"></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"DY~M9cv~$Wo{wr*?R[c,\">Error_D</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OV.-CSDwj(aOep[3Wy%o\">Error_P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"z_U*EpnX1dejdfI{S0Pn\">Error_P_old</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"z_U*EpnX1dejdfI{S0Pn\">Error_P_old</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OV.-CSDwj(aOep[3Wy%o\">Error_P</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"oxUYfi![}:kg@e_L^^S^\">PID_Val</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OV.-CSDwj(aOep[3Wy%o\">Error_P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">Kp</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"DY~M9cv~$Wo{wr*?R[c,\">Error_D</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">Kd</field></block></value></block></value></block></value><next><block type=\"motor_MotorRun\"><field name=\"index\">BitRacer.Motors.M_R</field><value name=\"PWM\"><shadow type=\"math_number_minmax\"><mutation min=\"-1000\" max=\"1000\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_constrain_value\"><value name=\"value\"><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">PWM</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"oxUYfi![}:kg@e_L^^S^\">PID_Val</field></block></value></block></value><value name=\"low\"><shadow type=\"math_number\"><field name=\"NUM\">-1000</field></shadow></value><value name=\"high\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value><next><block type=\"motor_MotorRun\"><field name=\"index\">BitRacer.Motors.M_L</field><value name=\"PWM\"><shadow type=\"math_number_minmax\"><mutation min=\"-1000\" max=\"1000\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_constrain_value\"><value name=\"value\"><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">PWM</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"oxUYfi![}:kg@e_L^^S^\">PID_Val</field></block></value></block></value><value name=\"low\"><shadow type=\"math_number\"><field name=\"NUM\">-1000</field></shadow></value><value name=\"high\"><shadow type=\"math_number\"><field name=\"NUM\">1000</field></shadow></value></block></value></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>","main.ts":"radio.onReceivedNumber(function (receivedNumber) {\n    // Handle driving modes\n    switch (receivedNumber) {\n        case 1:\n            駕駛模式 = 'human';\n            break;\n        case 2:\n            駕駛模式 = 'Platoon';\n            music.playTone(523, music.beat(BeatFraction.Quarter));\n            music.playTone(440, music.beat(BeatFraction.Quarter));\n            break;\n        case 881: // Exit Platoon mode\n            if (駕駛模式 === 'Platoon') {\n                music.playTone(440, music.beat(BeatFraction.Quarter));\n                music.playTone(523, music.beat(BeatFraction.Quarter));\n                駕駛模式 = 'human';\n            }\n            break;\n        default:\n            music.playTone(523, music.beat(BeatFraction.Quarter));\n            基本速度 = receivedNumber;\n            // if (駕駛模式 === 'Platoon') {\n            //     music.playTone(523, music.beat(BeatFraction.Quarter));\n            //     基本速度 = receivedNumber;\n            // }\n    }\n})\n\ninput.onButtonPressed(Button.A, function () {\n    前車距離 = sonar.ping(\n    DigitalPin.P1,\n    DigitalPin.P2,\n    PingUnit.Centimeters\n    )\n    basic.showNumber(前車距離)\n})\ninput.onButtonPressed(Button.AB, function () {\n    basic.showNumber(車序號)\n    music.playTone(523, music.beat(BeatFraction.Quarter))\n    while (true) {\n        前車距離 = sonar.ping(        DigitalPin.P1,        DigitalPin.P2,        PingUnit.Centimeters        )\n        \n        if (駕駛模式 == 'human') {\n            前車固定車距 = 10\n            車速 = Math.constrain(基本速度 , 1, 基本速度)\n            if (前車距離 < 前車固定車距){\n                車速 = 0 \n            }\n        }\n        else if (駕駛模式 == 'Platoon'){    \n            前車固定車距 = 7\n            車速 = Math.constrain(基本速度 + (前車距離 - 前車固定車距) * 車距kP, 1, Math.floor(基本速度*1.1) )\n        }\n        \n        PD控制(車速, kP, kD)\n        //廣播車子狀態\n        if (control.millis() > lastBT) {\n            radio.sendString(\"\" + 車序號 + \",\" + 前車距離 + \",\" + 車速)\n            lastBT = control.millis() + randint(30, 150)\n        }\n        basic.pause(迴圈間隔時間)\n    }\n})\ninput.onButtonPressed(Button.B, function () {\n    if (校正模式 == \"\") {\n        basic.showLeds(`\n            # # . # #\n            # # . # #\n            # # . # #\n            # # . # #\n            # # . # #\n            `)\n        music.playTone(523, music.beat(BeatFraction.Eighth))\n        BitRacer.CalibrateBegin()\n        校正模式 = \"黑線校正\"\n    } else if (校正模式 == \"黑線校正\") {\n        BitRacer.CalibrateEnd(BitRacer.LineColor.Black)\n        basic.showIcon(IconNames.Yes)\n        music.playTone(659, music.beat(BeatFraction.Eighth))\n        校正模式 = \"\"\n        basic.clearScreen()\n    }\n})\nfunction PD控制 (PWM: number, Kp: number, Kd: number) {\n    Error_P = 0 - BitRacer.readLine()\n    Error_D = Error_P - Error_P_old\n    Error_P_old = Error_P\n    PID_Val = Error_P * Kp + Error_D * Kd\n    BitRacer.motorRun(BitRacer.Motors.M_R, Math.constrain(PWM + PID_Val, -1000, 1000))\n    BitRacer.motorRun(BitRacer.Motors.M_L, Math.constrain(PWM - PID_Val, -1000, 1000))\n}\nlet PID_Val = 0\nlet Error_P_old = 0\nlet Error_D = 0\nlet Error_P = 0\nlet 校正模式 = \"\"\nlet lastBT = 0\nlet 車速 = 0\nlet 前車距離 = 0\nlet 基本速度 = 0\nlet 車距kP = 0\nlet 前車固定車距 = 0\nlet 車序號 = 0\nlet 迴圈間隔時間 = 0\nlet 駕駛模式 = \"\"\nlet kP = 0\nlet kD = 0\n\nradio.setTransmitPower(7)\nradio.setGroup(27)\n\n車序號 = 1\n\nif (車序號 == 1 || 車序號 == 5 || 車序號 == 6){\n    kP = 250\n    kD = 500\n}\nelse{\n    kP = 310\n    kD = 600\n}\n\n駕駛模式 = 'human'\n前車固定車距 = 7\n車距kP = 35\n基本速度 = 200\n迴圈間隔時間 = 5","README.md":"","pxt.json":"{\n    \"name\": \"113科技競賽-受控車\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\",\n        \"BitRacer\": \"github:51135499/bitracer#066fa557214aea79a82a79f73d2ddc5c665d3075\",\n        \"pxt-sonar\": \"github:microsoft/pxt-sonar#v0.0.6\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"targetVersions\": {\n        \"branch\": \"v3.0.56\",\n        \"tag\": \"v3.0.56\",\n        \"commits\": \"https://github.com/microsoft/pxt-microbit/commits/909804fd21584568bec02582650b4ca9ef64948c\",\n        \"target\": \"3.0.56\",\n        \"pxt\": \"6.0.34\"\n    },\n    \"preferredEditor\": \"tsprj\"\n}\n"}}],"shares":[],"lastSaveTime":1733908674261}